# תכנון דף ניהול הזמנות (Bookings)

דף ניהול ההזמנות הוא הדף המרכזי במערכת, המאפשר למנהלי בתי האירוח לצפות ולנהל את ההזמנות בצורה ויזואלית נוחה. הדף יציג לוח שנה/טבלת הזמנות עם אפשרויות ניווט, חיפוש ועריכה של הזמנות.

## מבנה הדף

הדף יורכב ממספר אזורים עיקריים:

1. **טאבים למעבר בין מקומות האירוח** - מינימליסטי בחלק העליון
2. **אזור כותרת וניווט עליון**
3. **אזור תצוגת התאריכים**
4. **לוח ההזמנות המרכזי**
5. **ממשק לצפייה/עריכת פרטי הזמנה**
6. **ממשק להוספת הזמנה חדשה**

## מבנה קבצים מתוכנן

הפיתוח יהיה מחולק למספר קבצים עיקריים:

```
client/src/
├── pages/
│   └── Bookings.js             # דף ראשי שמרכיב את כל הקומפוננטות
│
├── components/
│   └── bookings/
│       ├── BookingsHeader.js    # כותרת, טאבים וכפתורי פעולות
│       ├── BookingTabs.js       # מעבר בין Airport ל-Rothschild
│       ├── DateNavigation.js    # ניווט בין תאריכים
│       ├── BookingsCalendar.js  # תצוגת לוח השנה/טבלה המרכזית
│       ├── RoomsList.js         # רשימת החדרים (עמודה ימנית)
│       ├── BookingItem.js       # רכיב המציג הזמנה בודדת בטבלה
│       ├── NewBookingForm.js    # טופס להוספת הזמנה חדשה
│       ├── BookingDetails.js    # תצוגת פרטי הזמנה מלאים
│       ├── BookingFilters.js    # פילטרים לחיפוש והצגת הזמנות
│       ├── PriceCalculator.js   # רכיב לחישובי מחירים אוטומטיים
│       └── PaymentStatus.js     # רכיב לניהול סטטוס תשלום
```

## פירוט הרכיבים

### Bookings.js (דף ראשי)
- יאגד את כל הקומפוננטות
- ינהל את ה-state הראשי של הדף
- יכיל את הלוגיקה לטעינת נתוני ההזמנות מהשרת
- ניהול החלפה בין שני מקומות האירוח (Airport/Rothschild)
- **טעינת רשימת החדרים המעודכנת** לפי המיקום הנבחר ישירות מאותו מאגר נתונים שמשמש את דפי ההגדרות
- **טעינת מחירי ברירת המחדל** מהגדרות החדרים במיקום הנבחר

### BookingTabs.js
- טאבים מינימליסטיים למעבר בין Airport Guest House לבין Rothschild
- עיצוב נקי ומינימליסטי תואם את ה-DesignGuidelines
- שינוי צבע האקסנט בהתאם למיקום הנבחר (תכלת לאיירפורט, סגול לרוטשילד)
- **עדכון תצוגת החדרים** בהתאם למיקום הנבחר
- **עדכון טווח המחירים** בהתאם להגדרות המיקום הנבחר

### BookingsHeader.js
- כותרת הדף מינימליסטית
- כפתור "הזמנה חדשה" שפותח טופס הזמנה חדשה
- אזור חיפוש הזמנות (חיפוש לפי שם, מספר הזמנה וכו')

### DateNavigation.js
- הצגת טווח התאריכים הנוכחי (לדוגמה: 28/04 - 21/04)
- חצים לניווט קדימה ואחורה בטווחי תאריכים
- אפשרות לבחירת טווח תאריכים מותאם אישית

### BookingsCalendar.js
- תצוגת הטבלה/לוח השנה המרכזית
- יציג את המידע המרכזי של התאריכים והזמנות בצורה ויזואלית
- יתממשק עם RoomsList לתצוגה משולבת
- יציג את שמות האורחים או מצב החדר בתאים המתאימים

### RoomsList.js
- עמודה ימנית שמציגה את מספרי החדרים
- **סנכרון אוטומטי** עם החדרים שהוגדרו ב-`settings/rooms/airport` ו-`settings/rooms/rothschild`
- הצגת רשימת החדרים הרלוונטית למיקום הנבחר (Airport או Rothschild)
- תמיכה בחלוקה לפי סוגי חדרים או קומות
- **שמירת מידע על מחירי החדרים** כפי שהוגדרו בהגדרות כל חדר

### BookingItem.js
- ייצוג ויזואלי של הזמנה בודדת בטבלה
- קוד צבעים לסטטוס שונה של הזמנות (מאושר, בתהליך, בוטל וכו')
- אירועי לחיצה לצפייה/עריכה של פרטי ההזמנה

### NewBookingForm.js
- טופס להוספת הזמנה חדשה עם כל השדות הנדרשים
- חלוקה לשלושה אזורים: פרטי אורח, פרטי הזמנה, פרטי תשלום והערות
- **בחירת חדר מתוך הרשימה המעודכנת של החדרים הזמינים** שמגיעה מדפי ההגדרות, בהתאם למיקום הנבחר
- **מנגנון חישוב אוטומטי מתקדם** לתאריכים, מספר לילות ומחירים (ראה פירוט ב-PriceCalculator.js)
- **שימוש במחירי ברירת מחדל** שמוגדרים לכל חדר בדפי ההגדרות הרלוונטיים (`settings/rooms/airport` ו-`settings/rooms/rothschild`)
- בחירת חדר תטען אוטומטית את המחיר שהוגדר עבורו בדפי ההגדרות

#### פרטי אורח:
- שם משפחה
- טלפון
- אימייל

#### פרטי הזמנה:
- מספר לילות (יחושב אוטומטית מתאריכים או ישנה את תאריך הצ'ק-אאוט בהתאם לשינוי)
- צ'ק אין (תאריך כניסה) - בחירה מלוח שנה
- צ'ק אאוט (תאריך יציאה) - יחושב אוטומטית מתאריך צ'ק-אין + מספר לילות
- חדר - בחירה מתפריט נפתח המציג את החדרים שהוגדרו במסכי ההגדרות הרלוונטיים
- תיור (checkbox) - משפיע על חישוב המע"מ

#### פרטי תשלום והערות:
- סה"כ להזמנה (₪) - מחושב אוטומטית אך ניתן לעריכה, משפיע על שאר השדות
- מחיר לילה (כולל מע"מ) (₪) - מחושב אוטומטית אך ניתן לעריכה, משפיע על שאר השדות
- מחיר לילה (ללא מע"מ) (₪) - מחושב אוטומטית אך ניתן לעריכה, משפיע על שאר השדות
- פרטי תשלום:
  - מספר כרטיס
  - שם בעל הכרטיס
  - תוקף
  - CVV
- הערות נוספות להזמנה (אזור טקסט)

### PriceCalculator.js
- רכיב אחראי על החישובים האוטומטיים והחכמים של מחירים ותאריכים
- **טעינת מחירי ברירת המחדל** מהגדרות החדרים כפי שהוגדרו ב-`settings/rooms/airport` ו-`settings/rooms/rothschild`
- **מנגנון סנכרון בין תאריכים ומספר לילות**:
  - ברירת מחדל: לילה אחד (צ'ק-אין היום, צ'ק-אאוט מחר)
  - שינוי במספר הלילות אוטומטית יעדכן את תאריך הצ'ק-אאוט
  - שינוי בטווח התאריכים (צ'ק-אין/אאוט) יעדכן את מספר הלילות

- **מנגנון חישוב מחירים אוטומטי**:
  - קביעת שיעור מע"מ קבוע של 18%
  - חישוב דו-כיווני: שינוי באחד מהשדות יעדכן את השדות האחרים
  - כשמשנים את "מחיר ללילה" (עם/בלי מע"מ) - יתעדכן "סה"כ להזמנה" = מחיר ללילה * מספר לילות
  - כשמשנים את "סה"כ להזמנה" - יתעדכן "מחיר ללילה" = סה"כ להזמנה / מספר לילות
  - מחיר ללא מע"מ = מחיר כולל מע"מ / 1.18 (מעוגל לספרה אחת אחרי הנקודה)
  - **שימוש במחירי ברירת מחדל** כאשר נפתח חלון הזמנה חדשה או כאשר מחליפים חדר

- **התנהגות מיוחדת עבור תיירים**:
  - כאשר מסומן checkbox "תייר", אין חישוב מע"מ
  - במקרה כזה, "מחיר ללילה כולל מע"מ" זהה ל"מחיר ללילה ללא מע"מ"

- **מניעת חישובים כפולים**:
  - שימוש בחישוב יציב שמונע שינויים לא רצויים בסכום הסופי בעת שמירה
  - מנגנון "נעילה" שמונע חישובים מעגליים כשמעדכנים שדה אחד
  - שמירת הערכים המקוריים והמחושבים בנפרד למניעת עיגול חוזר

### PaymentStatus.js
- רכיב לניהול סטטוס תשלום עם אפשרויות:
  - לא שולם (ברירת מחדל)
  - מזומן
  - אשראי אור יהודה
  - אשראי רוטשילד
  - העברה מזרחי
  - ביט מזרחי
  - פייבוקס מזרחי
  - העברת פועלים
  - ביט פועלים
  - פייבוקס פועלים
  - אחר
- בחירת סטטוס באמצעות תפריט נפתח (dropdown)
- אפשרות להוספת הערות תשלום

### BookingDetails.js
- תצוגה מלאה של פרטי ההזמנה
- אפשרויות עריכה, ביטול או שינוי סטטוס
- היסטוריית שינויים ופעולות על ההזמנה

### BookingFilters.js
- פילטרים לסינון ההזמנות המוצגות
- סינון לפי סטטוס, תאריכים, אתר (Airport/Rothschild)
- שמירת העדפות תצוגה

## סנכרון נתונים ואינטגרציה

### סנכרון עם ניהול החדרים
- **קשר הדוק** בין החדרים המוגדרים בדפי ההגדרות (`settings/rooms/airport` ו-`settings/rooms/rothschild`) לבין החדרים המוצגים בדף ההזמנות
- שינויים בהגדרות החדרים (הוספה, עריכה, מחיקה) **ישתקפו מיידית** בדף ההזמנות
- מידע על סוגי החדרים, קיבולת, ומאפיינים מיוחדים יסתמך על נתוני החדרים שהוגדרו במסכי ההגדרות
- **היררכיית נתונים מסודרת** שמבטיחה עקביות בין כל חלקי המערכת
- **סנכרון מחירים אוטומטי** - המחירים המוגדרים בהגדרות החדרים ישמשו כברירת מחדל בטופס ההזמנה החדשה

### חישובים אוטומטיים חכמים
- **מנגנון חישובים יציב ומדויק** המבטיח עקביות בחישובי המחירים
- אלגוריתם מיוחד למניעת בעיות עיגול כשמשנים שדות בטופס
- אפשרות לנעול שדה מסוים (לדוגמה "סה"כ להזמנה") ולאפשר לשאר השדות להתעדכן אוטומטית
- תיעוד מדויק של ההיסטוריה לכל שינוי במחירים, כדי להבין מה היה החישוב המקורי
- **שימוש במחירי ברירת המחדל** מהגדרות החדרים כנקודת התחלה לכל הזמנה חדשה

### ניהול המידע
- **מבנה נתונים מאוחד** המקשר בין הזמנות לחדרים
- API endpoints שישמשו את כל חלקי המערכת בצורה עקבית
- **מניעת כפילויות** בהגדרות חדרים והזמנות
- **שמירת מחירי החדרים במודל הנתונים** כך שישמשו אוטומטית כברירת מחדל בטופס ההזמנה החדשה

### עדכון בזמן אמת
- שינויים בהגדרות החדרים ישפיעו באופן אוטומטי על האפשרויות בדף ההזמנות
- עדכון מיידי של התצוגה כאשר מתווספים או משתנים חדרים
- **בדיקות תקינות** למניעת סתירות בין הזמנות לחדרים זמינים
- **עדכון מחירים בזמן אמת** - שינוי במחיר חדר בדפי ההגדרות ישפיע מיידית על הזמנות חדשות

## עיצוב וסגנון

- עיצוב מינימליסטי ונקי בהתאם למסמך ה-DesignGuidelines
- שימוש בצבעים ייעודיים לכל אתר (Airport בתכלת, Rothschild בסגול)
- ממשק משתמש פשוט וישיר ללא כותרות או הסברים מיותרים
- אלמנטים בעיצוב מינימליסטי עם:
  - מרווחים לבנים מספקים
  - טיפוגרפיה קריאה
  - שימוש בצבעים רק לאלמנטים פעילים ואינדיקציות

## עיצוב מפורט לדף ההזמנות

בהתאם להנחיות העיצוב הכלליות של המערכת, דף ההזמנות יתאפיין בעיצוב ייחודי המדגיש את זרימת העבודה עם הזמנות ואת ההבדלים בין שני אתרי המלון.

### 1. זהות ויזואלית לפי מיקום

#### צבעים ראשיים
- **Airport Guest House**: צבע תכלת (`#64d2ff`) עם רקע בהיר (`rgba(100, 210, 255, 0.1)`)
- **רוטשילד**: צבע סגול (`#5e5ce6`) עם רקע בהיר (`rgba(94, 92, 230, 0.1)`)

#### אייקונים מזהים
- **Airport Guest House**: אייקון מטוס בצבע תכלת
- **רוטשילד**: אייקון בניין/בית בצבע סגול

#### טאבים למעבר בין אתרים
```jsx
<Tabs 
  value={location} 
  onChange={handleLocationChange}
  variant="fullWidth"
  TabIndicatorProps={{
    style: {
      backgroundColor: locationColors.main,
      height: '3px',
    }
  }}
  sx={{ 
    mb: 3, 
    '& .MuiTab-root': {
      fontWeight: 500,
      fontSize: '1rem',
      textTransform: 'none',
      minHeight: '48px',
      color: 'text.secondary',
      borderBottom: '1px solid',
      borderColor: 'divider',
    },
    '& .Mui-selected': {
      color: locationColors.main,
    }
  }}
>
  <Tab 
    icon={<FlightIcon fontSize="small" />} 
    iconPosition="start" 
    label="Airport Guest House" 
    value="airport" 
  />
  <Tab 
    icon={<HomeIcon fontSize="small" />} 
    iconPosition="start" 
    label="רוטשילד" 
    value="rothschild" 
  />
</Tabs>
```

### 2. כותרת דף ההזמנות

```jsx
<Box sx={{ 
  mb: 4,
  pt: 2,
  display: 'flex',
  alignItems: 'center'
}}>
  <Box 
    sx={{ 
      mr: 3.5, 
      bgcolor: locationColors.bgLight, 
      p: 1.5, 
      borderRadius: 2,
      display: 'flex'
    }}
  >
    <BookIcon sx={{ color: locationColors.main, fontSize: 28 }} />
  </Box>
  <Typography variant="h4" component="h1" sx={{ fontWeight: 500, color: 'text.primary' }}>
    ניהול הזמנות
  </Typography>
</Box>
```

### 3. עיצוב לוח ההזמנות

#### רכיב BookingsCalendar
- **מסגרת מעוגלת**: `borderRadius: '14px'`
- **צבע כותרות**: בהתאם למיקום (תכלת לאיירפורט, סגול לרוטשילד)
- **גריד עם קווי הפרדה דקים**: `borderColor: 'rgba(0, 0, 0, 0.08)'`
- **רקע תאים בריחוף**: `'&:hover': { bgcolor: locationColors.bgLight }`
- **תא עם הזמנה פעילה**: הדגשה באמצעות רקע צבעוני בהיר

```jsx
<Paper 
  sx={{ 
    p: 0, 
    borderRadius: '14px', 
    overflow: 'hidden',
    boxShadow: '0 2px 8px rgba(0,0,0,0.05)',
  }}
>
  <TableContainer component="div">
    <Table stickyHeader>
      <TableHead>
        <TableRow sx={{ 
          '& th': { 
            fontWeight: 600, 
            bgcolor: locationColors.bgLight,
            color: locationColors.main,
            borderBottom: `2px solid ${locationColors.main}`,
          } 
        }}>
          <TableCell sx={{ py: 2 }}>תאריך</TableCell>
          {/* תאי כותרת נוספים */}
        </TableRow>
      </TableHead>
      <TableBody>
        {/* תוכן הטבלה */}
      </TableBody>
    </Table>
  </TableContainer>
</Paper>
```

#### רשימת החדרים (RoomsList)
- **רקע לבן** עם מסגרת מעוגלת
- **הדגשת חדרים לפי קטגוריה** באמצעות קודי צבע עדינים
- **אינדיקציית מצב** (זמין/תפוס) באמצעות נקודת צבע קטנה

```jsx
<Paper sx={{ 
  p: 2, 
  borderRadius: '14px', 
  height: '100%',
  boxShadow: '0 2px 8px rgba(0,0,0,0.05)',
}}>
  <Typography variant="subtitle1" sx={{ fontWeight: 500, mb: 2 }}>
    חדרים
  </Typography>
  <List disablePadding>
    {rooms.map(room => (
      <ListItem 
        key={room.id}
        sx={{
          borderRadius: 1,
          mb: 1,
          '&:hover': { bgcolor: locationColors.bgLight }
        }}
      >
        <ListItemIcon sx={{ minWidth: '32px' }}>
          <Box
            sx={{
              width: 8,
              height: 8,
              borderRadius: '50%',
              bgcolor: room.isAvailable ? 'success.main' : 'text.disabled'
            }}
          />
        </ListItemIcon>
        <ListItemText 
          primary={`חדר ${room.roomNumber}`}
          secondary={room.category}
          primaryTypographyProps={{ fontWeight: 500 }}
          secondaryTypographyProps={{ fontSize: '0.75rem' }}
        />
      </ListItem>
    ))}
  </List>
</Paper>
```

### 4. רכיבי ניווט ופעולות

#### DateNavigation
טורקיז עדינה אבל אלגנטית, המאפשרת ניווט אינטואיטיבי בין תאריכים:

```jsx
<Paper sx={{ 
  p: 2, 
  borderRadius: '14px', 
  mb: 3,
  display: 'flex',
  alignItems: 'center',
  justifyContent: 'space-between'
}}>
  <IconButton 
    size="small" 
    onClick={handlePreviousPeriod}
    sx={{ 
      color: locationColors.main,
      '&:hover': { bgcolor: locationColors.bgLight }
    }}
  >
    <ChevronRightIcon />
  </IconButton>

  <Box sx={{ display: 'flex', alignItems: 'center' }}>
    <Typography variant="subtitle1" sx={{ fontWeight: 500, mx: 2 }}>
      {formatDateRange(startDate, endDate)}
    </Typography>
    <Button 
      size="small" 
      startIcon={<CalendarTodayIcon />}
      onClick={handleOpenDatePicker}
      sx={{ 
        color: locationColors.main,
        borderColor: locationColors.main,
        '&:hover': { bgcolor: locationColors.bgLight }
      }}
      variant="outlined"
    >
      בחר תאריכים
    </Button>
  </Box>

  <IconButton 
    size="small" 
    onClick={handleNextPeriod}
    sx={{ 
      color: locationColors.main,
      '&:hover': { bgcolor: locationColors.bgLight }
    }}
  >
    <ChevronLeftIcon />
  </IconButton>
</Paper>
```

#### כפתור הוספת הזמנה חדשה
כפתור מרכזי בעל נוכחות בולטת בצבע ירוק להוספת הזמנה חדשה:

```jsx
<Button 
  variant="contained" 
  startIcon={<AddIcon />}
  onClick={handleAddBooking}
  sx={{ 
    bgcolor: 'var(--accent-green)', 
    '&:hover': { bgcolor: 'var(--accent-green)', opacity: 0.9 },
    boxShadow: 'none',
    borderRadius: '8px',
    textTransform: 'none',
    fontWeight: 500,
    px: 2.5,
    py: 1
  }}
>
  הזמנה חדשה
</Button>
```

### 5. טופס הזמנה חדשה

טופס אלגנטי עם שלושה חלקים ברורים ומופרדים:

```jsx
<Dialog 
  open={open} 
  onClose={handleClose}
  maxWidth="md"
  fullWidth
  PaperProps={{
    sx: {
      borderRadius: '14px',
      p: 0,
      overflow: 'hidden'
    }
  }}
>
  <DialogTitle sx={{ 
    bgcolor: locationColors.bgLight, 
    color: locationColors.main,
    fontWeight: 500,
    display: 'flex',
    alignItems: 'center',
    borderBottom: `1px solid ${locationColors.main}`
  }}>
    <AddIcon sx={{ mr: 1 }} />
    הזמנה חדשה
  </DialogTitle>
  
  <DialogContent sx={{ p: 3, mt: 2 }}>
    <Grid container spacing={3}>
      {/* חלק 1: פרטי אורח */}
      <Grid item xs={12}>
        <Paper sx={{ 
          p: 3, 
          borderRadius: '14px',
          boxShadow: '0 2px 6px rgba(0,0,0,0.05)',
          borderTop: `3px solid ${locationColors.main}`
        }}>
          <Typography variant="h6" sx={{ mb: 2, fontWeight: 500 }}>
            פרטי אורח
          </Typography>
          {/* שדות טופס */}
        </Paper>
      </Grid>
      
      {/* חלק 2: פרטי הזמנה */}
      <Grid item xs={12}>
        <Paper sx={{ 
          p: 3, 
          borderRadius: '14px',
          boxShadow: '0 2px 6px rgba(0,0,0,0.05)',
          borderTop: `3px solid ${locationColors.main}`
        }}>
          <Typography variant="h6" sx={{ mb: 2, fontWeight: 500 }}>
            פרטי הזמנה
          </Typography>
          {/* שדות טופס */}
        </Paper>
      </Grid>
      
      {/* חלק 3: פרטי תשלום והערות */}
      <Grid item xs={12}>
        <Paper sx={{ 
          p: 3, 
          borderRadius: '14px',
          boxShadow: '0 2px 6px rgba(0,0,0,0.05)',
          borderTop: `3px solid ${locationColors.main}`
        }}>
          <Typography variant="h6" sx={{ mb: 2, fontWeight: 500 }}>
            פרטי תשלום והערות
          </Typography>
          {/* שדות טופס */}
        </Paper>
      </Grid>
    </Grid>
  </DialogContent>
  
  <DialogActions sx={{ px: 3, py: 2, borderTop: '1px solid', borderColor: 'divider' }}>
    <Button 
      onClick={handleClose}
      variant="text"
      sx={{ color: 'text.secondary' }}
    >
      ביטול
    </Button>
    <Button 
      variant="contained" 
      onClick={handleSaveBooking}
      sx={{ 
        bgcolor: 'var(--accent-green)', 
        '&:hover': { bgcolor: 'var(--accent-green)', opacity: 0.9 },
        boxShadow: 'none'
      }}
    >
      שמירה
    </Button>
  </DialogActions>
</Dialog>
```

### 6. עיצוב פריט הזמנה (BookingItem)

```jsx
<Box 
  sx={{ 
    p: 1.5, 
    borderRadius: '10px', 
    bgcolor: bookingStatusColors[booking.status].bgColor,
    border: '1px solid',
    borderColor: bookingStatusColors[booking.status].borderColor,
    cursor: 'pointer',
    transition: 'transform 0.2s ease, box-shadow 0.2s ease',
    '&:hover': {
      transform: 'translateY(-2px)',
      boxShadow: '0 3px 10px rgba(0,0,0,0.08)'
    }
  }}
  onClick={() => handleViewBookingDetails(booking.id)}
>
  <Typography variant="subtitle2" noWrap sx={{ fontWeight: 500 }}>
    {booking.guestName}
  </Typography>
  <Box sx={{ display: 'flex', alignItems: 'center', mt: 0.5 }}>
    <Box
      sx={{
        width: 6,
        height: 6,
        borderRadius: '50%',
        bgcolor: bookingStatusColors[booking.status].dotColor,
        mr: 0.5
      }}
    />
    <Typography variant="caption" sx={{ color: 'text.secondary' }}>
      {booking.status}
    </Typography>
  </Box>
</Box>
```

### 7. מערכת צבעי סטטוס

ציר צבעים עקבי לסטטוס הזמנות שמקל על זיהוי מצב ההזמנה במבט מהיר:

```jsx
const bookingStatusColors = {
  confirmed: {
    bgColor: 'rgba(48, 209, 88, 0.1)',
    borderColor: 'rgba(48, 209, 88, 0.2)',
    dotColor: '#30d158'  // accent-green
  },
  pending: {
    bgColor: 'rgba(255, 149, 0, 0.1)',
    borderColor: 'rgba(255, 149, 0, 0.2)',
    dotColor: '#ff9500'  // warning
  },
  cancelled: {
    bgColor: 'rgba(255, 55, 95, 0.1)',
    borderColor: 'rgba(255, 55, 95, 0.2)',
    dotColor: '#ff375f'  // accent-pink
  },
  completed: {
    bgColor: 'rgba(94, 92, 230, 0.1)',
    borderColor: 'rgba(94, 92, 230, 0.2)',
    dotColor: '#5e5ce6'  // accent-purple/indigo
  }
};
```

### 8. רספונסיביות

- **ברזולוציות גבוהות**: תצוגת גריד מלאה עם כל הפרטים
- **בטאבלטים**: התאמות בגודל הפונט וצפיפות המידע
- **במובייל**: מעבר לתצוגת רשימה מתחת לבורר התאריכים

```jsx
// דוגמה לנקודות שבירה רספונסיביות
const isDesktop = useMediaQuery(theme => theme.breakpoints.up('md'));
const isTablet = useMediaQuery(theme => theme.breakpoints.between('sm', 'md'));
const isMobile = useMediaQuery(theme => theme.breakpoints.down('sm'));

// ואז בתוך הרנדור
{isDesktop && <FullCalendarView />}
{isTablet && <CompactCalendarView />}
{isMobile && <ListView />}
```

### 9. אנימציות

אנימציות עדינות לשיפור חוויית המשתמש:
- **מעברי טאבים**: החלקה עם שינוי צבע הדרגתי
- **פתיחת טפסים**: Fade in מאנימץ
- **תגובה לריחוף**: התרוממות קלה של פריטים
- **שמירת נתונים**: אנימציית התקדמות זוהרת בכפתור השמירה

```jsx
// דוגמה לאנימציית טעינה בכפתור שמירה
const [isSaving, setIsSaving] = useState(false);

<Button 
  variant="contained" 
  onClick={handleSaveBooking}
  disabled={isSaving}
  sx={{ 
    bgcolor: 'var(--accent-green)', 
    position: 'relative',
    overflow: 'hidden',
    '&:hover': { bgcolor: 'var(--accent-green)', opacity: 0.9 },
    boxShadow: 'none'
  }}
>
  {isSaving && (
    <Box 
      sx={{
        position: 'absolute',
        top: 0,
        left: 0,
        right: 0,
        bottom: 0,
        bgcolor: 'rgba(255,255,255,0.2)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center'
      }}
    >
      <CircularProgress size={24} color="inherit" />
    </Box>
  )}
  שמירה
</Button>
```

כל ההנחיות הללו יכובדו בכל שלבי הפיתוח לשמירה על אחידות וחוויית משתמש איכותית לאורך כל המערכת.

## אינטראקציות וחוויית משתמש

1. **מעבר בין מקומות האירוח**:
   - החלפה פשוטה באמצעות הטאבים העליונים
   - שינוי צבעי ממשק בהתאם למקום האירוח הנבחר
   - **החלפה אוטומטית של רשימת החדרים** בהתאם למיקום הנבחר
   - **טעינה אוטומטית של טווח המחירים** הרלוונטי למיקום הנבחר

2. **צפייה בהזמנות**:
   - גלילה אנכית לחדרים שונים
   - גלילה אופקית לתאריכים
   - ניווט מהיר בין תקופות זמן

3. **עריכת הזמנות**:
   - לחיצה על הזמנה תציג את פרטי ההזמנה המלאים
   - גרירה של הזמנות לשינוי תאריכים/חדרים (אופציונלי - יתווסף בהמשך)
   
4. **הוספת הזמנה חדשה**:
   - פתיחת טופס הזמנה חדשה עם כל השדות הנדרשים
   - בחירת חדר מתוך הרשימה המעודכנת של החדרים הזמינים
   - **טעינה אוטומטית של מחירי ברירת המחדל** לפי החדר שנבחר, כפי שהוגדרו בדפי ההגדרות
   - בחירת טווח תאריכים מהירה
   - **חישוב אוטומטי של מחירים ותאריכים** תוך התחשבות בכל השינויים בזמן אמת

5. **ניהול תשלומים**:
   - שינוי סטטוס תשלום בקלות
   - בחירת אמצעי תשלום מהתפריט הנפתח

## שמירת נתונים

- כל הנתונים יישמרו בשרת MongoDB
- מבנה הנתונים יתוכנן כך שיתמוך בכל השדות והמידע הנדרש לניהול ההזמנות
- יצירת API endpoints לביצוע פעולות CRUD על ההזמנות
- הפרדה בין נתוני Airport Guest House לבין Rothschild
- **שימוש במודלים משותפים** להגדרות חדרים ולהזמנות לשמירה על עקביות הנתונים
- **שמירת מחירי החדרים במודל הנתונים** כך שישמשו אוטומטית כברירת מחדל בטופס ההזמנה החדשה
- שמירת היסטוריית שינויים ופעולות (אופציונלי)

## תוכנית עבודה: פיתוח מערכת ההזמנות ב-5 שלבים

כדי לבנות את מערכת ניהול ההזמנות באופן יעיל ומדורג, נחלק את העבודה ל-5 שלבים עיקריים. כל שלב בנוי על הקודם לו ומוסיף פונקציונליות משמעותית למערכת.

### שלב 1: תשתית צד שרת והגדרת מודלים

**מטרה:** הקמת תשתית הנתונים ומודל ה-API לניהול הזמנות.

**משימות:**
1. **הגדרת מודל הנתונים (Booking Schema):**
   - יצירת מודל Booking.js במסד הנתונים עם כל השדות הדרושים
   - הגדרת קשרים בין מודל ההזמנות למודל החדרים הקיים
   - הוספת שדות לטיפול בכל המידע הנדרש (פרטי אורח, תאריכים, מחירים, וכו')

2. **פיתוח נתיבי API בסיסיים:**
   - יצירת קובץ routes/bookings.js עם נתיבי ה-API הבסיסיים
   - יצירת קובץ controllers/bookingsController.js עם לוגיקת הבקרה
   - מימוש פעולות CRUD בסיסיות (יצירה, קריאה, עדכון, מחיקה של הזמנות)
   - מימוש סינון הזמנות לפי מיקום (Airport/Rothschild)

3. **סנכרון עם מודל החדרים:**
   - הרחבת ה-API להבאת נתוני חדרים תואמים למיקום הנבחר
   - הוספת לוגיקה לבדיקת זמינות חדרים בתאריכים מסוימים
   - יצירת מנגנון לשליפת מחירי ברירת מחדל מהחדרים

4. **חיבור ל-MongoDB וטעינת נתוני דוגמה:**
   - הגדרת חיבור למסד הנתונים
   - יצירת סקריפט לטעינת נתוני דוגמה ראשוניים
   - בדיקות API באמצעות Postman או כלי דומה

**תוצרים:**
- מודל נתונים מלא עם כל השדות הנדרשים
- API endpoints פעילים לניהול הזמנות
- תשתית לסנכרון בין הזמנות לחדרים

### שלב 2: תשתית צד לקוח ורכיבים בסיסיים

**מטרה:** הקמת הקומפוננטות הבסיסיות של ממשק המשתמש והתשתית לדף ההזמנות.

**משימות:**
1. **הקמת הדף הראשי והרכיבים הבסיסיים:**
   - יצירת קובץ Bookings.js הראשי עם המבנה הבסיסי
   - יצירת BookingTabs.js למעבר בין איירפורט לרוטשילד
   - יצירת BookingsHeader.js עם כותרת ואפשרויות חיפוש בסיסיות
   - יצירת DateNavigation.js לניווט בין תאריכים

2. **פיתוח תשתית לתצוגת לוח ההזמנות:**
   - יצירת BookingsCalendar.js עם התשתית הבסיסית לתצוגת טבלת הזמנות
   - יצירת RoomsList.js עם תצוגת החדרים הבסיסית
   - עיצוב ראשוני של הרכיבים בהתאם למסמך ה-DesignGuidelines
   - יצירת BookingItem.js לתצוגה בסיסית של פריט הזמנה בודד

3. **חיבור ראשוני ל-API:**
   - הקמת שירותי API בצד הלקוח (services/api/bookings.js)
   - מימוש פונקציות לטעינת נתוני הזמנות מהשרת
   - מימוש פונקציות לטעינת רשימת חדרים לפי מיקום
   - הצגת נתונים ראשוניים בלוח ההזמנות

4. **מימוש ניווט ומעבר בין תאריכים:**
   - פיתוח לוגיקת ניווט בתאריכים (קדימה/אחורה)
   - הוספת אפשרות לבחירת טווח תאריכים מותאם אישית
   - עדכון תצוגת הטבלה בהתאם לשינויי תאריכים

**תוצרים:**
- מבנה בסיסי של דף ההזמנות עם כל הרכיבים העיקריים
- מעבר בין מקומות האירוח (Airport/Rothschild)
- תצוגה ראשונית של לוח הזמנות עם נתונים אמיתיים מהשרת
- ניווט בין תאריכים פעיל

### שלב 3: ממשק הוספת הזמנה וחישובי מחירים

**מטרה:** פיתוח טופס יצירת הזמנה חדשה עם מנגנון חישוב מחירים מתקדם.

**משימות:**
1. **פיתוח טופס הזמנה חדשה:**
   - יצירת NewBookingForm.js מלא עם כל השדות הנדרשים
   - חלוקת הטופס לאזורים (פרטי אורח, פרטי הזמנה, תשלום והערות)
   - הוספת בקרות (validations) לאימות נתונים בטופס
   - עיצוב הטופס בהתאם למסמך ה-DesignGuidelines

2. **פיתוח מנגנון חישוב מחירים אוטומטי:**
   - יצירת PriceCalculator.js עם לוגיקת החישובים המתקדמת
   - מימוש חישוב דו-כיווני בין כל שדות המחיר
   - פיתוח מנגנון סנכרון בין תאריכים ומספר לילות
   - מימוש התנהגות מיוחדת עבור תיירים (ללא מע"מ)
   - מימוש מניעת חישובים כפולים ומעגליים

3. **סנכרון עם מחירי חדרים:**
   - מימוש טעינת מחירי ברירת מחדל מהחדרים
   - עדכון מחירים אוטומטי בעת בחירת חדר
   - עדכון מחירים אוטומטי בעת שינוי תאריכים
   - פיתוח לוגיקה מיוחדת למחירי סופ"ש

4. **פיתוח רכיב סטטוס תשלום:**
   - יצירת PaymentStatus.js עם אפשרויות התשלום השונות
   - הטמעת רכיב סטטוס התשלום בטופס ההזמנה
   - שמירה ועדכון של נתוני תשלום בשרת

5. **חיבור טופס ההזמנה ל-API:**
   - מימוש שמירת הזמנה חדשה בשרת
   - טיפול בשגיאות ותגובות מהשרת
   - הצגת הודעות הצלחה/שגיאה למשתמש

**תוצרים:**
- טופס הזמנה חדשה מלא ופעיל
- מנגנון חישוב מחירים חכם ואוטומטי
- סנכרון מלא עם מחירי החדרים מדפי ההגדרות
- אפשרות ליצירת הזמנות חדשות ושמירתן במערכת

### שלב 4: תצוגת פרטי הזמנה, עריכה וסינון

**מטרה:** השלמת פונקציונליות מלאה של המערכת כולל עריכת הזמנות וסינון.

**משימות:**
1. **פיתוח תצוגת פרטי הזמנה:**
   - יצירת BookingDetails.js עם תצוגה מלאה של פרטי ההזמנה
   - עיצוב חלון פרטי ההזמנה בהתאם למסמך ה-DesignGuidelines
   - הוספת אפשרויות לעריכה, ביטול או שינוי סטטוס ההזמנה
   - תצוגת היסטוריית שינויים ופעולות על ההזמנה

2. **מימוש עריכת הזמנות:**
   - שימוש בטופס ההזמנה גם לצורך עריכת הזמנות קיימות
   - שמירת השינויים בהזמנה קיימת
   - מימוש ביטול הזמנה
   - טיפול בסתירות אפשריות בתאריכים וחדרים בעת עריכה

3. **פיתוח רכיב פילטרים:**
   - יצירת BookingFilters.js עם אפשרויות סינון מתקדמות
   - מימוש סינון לפי סטטוס, תאריכים, אתר
   - שמירת העדפות תצוגה של המשתמש
   - עדכון לוח ההזמנות בהתאם לפילטרים שנבחרו

4. **מימוש חיפוש הזמנות:**
   - פיתוח אפשרות חיפוש לפי שם, מספר הזמנה, טלפון וכו'
   - עדכון תצוגת לוח ההזמנות בהתאם לתוצאות החיפוש
   - הטמעת חיפוש בזמן אמת (real-time)

5. **הרחבת פונקציונליות ה-API:**
   - הוספת אפשרויות סינון וחיפוש בצד השרת
   - מימוש עדכון והיסטוריית שינויים
   - אופטימיזציה של שאילתות למסד הנתונים

**תוצרים:**
- תצוגת פרטי הזמנה מלאה
- אפשרות לעריכה וביטול הזמנות
- פילטרים וחיפוש מתקדמים
- API מורחב עם תמיכה בסינון וחיפוש

### שלב 5: אופטימיזציה, UI/UX משופר ותכונות מתקדמות

**מטרה:** שיפור חוויית המשתמש, הוספת תכונות מתקדמות וביצוע אופטימיזציה.

**משימות:**
1. **שיפורי UI/UX:**
   - עידון סופי של העיצוב בהתאם למסמך ה-DesignGuidelines
   - הוספת אנימציות ומעברים מינימליסטיים
   - התאמת צבעים בהתאם למיקום (תכלת לאיירפורט, סגול לרוטשילד)
   - שיפור תצוגה במסכים בגדלים שונים (responsive)

2. **אופטימיזציה של ביצועים:**
   - שיפור זמני טעינה וביצועים
   - מימוש caching של נתונים בצד הלקוח
   - אופטימיזציה של שאילתות למסד הנתונים
   - מניעת rendering מיותר ברכיבים

3. **תכונות מתקדמות:**
   - הוספת אפשרות גרירה (drag & drop) של הזמנות בלוח ההזמנות
   - מימוש ייצוא נתונים (CSV/Excel)
   - הוספת אפשרות להדפסת הזמנה או שליחה במייל
   - מימוש התראות למשתמש (נכנסים היום/מחר, תשלום חסר וכו')

4. **בדיקות מקיפות:**
   - בדיקות יחידה וקומפוננטות
   - בדיקות אינטגרציה בין כל חלקי המערכת
   - בדיקות cross-browser
   - בדיקות בתרחישים מורכבים (סתירות, מקרי קצה)

5. **תיעוד והשלמת הפרויקט:**
   - תיעוד API מלא
   - הכנת מדריך למשתמש בסיסי
   - סריקה אחרונה לבאגים ותיקונם
   - השלמת תכונות חסרות וליטוש סופי

**תוצרים:**
- מערכת ניהול הזמנות מלאה עם UX משופר
- ביצועים אופטימליים
- תכונות מתקדמות שמשפרות את חוויית המשתמש
- מערכת בדוקה ומתועדת היטב

## סיכום תהליך הפיתוח

תהליך פיתוח מערכת ניהול ההזמנות בחמישה שלבים אלו מאפשר:
1. התקדמות הדרגתית - בכל שלב נוספת פונקציונליות משמעותית
2. עקביות - הקפדה על סנכרון בין החדרים וההזמנות
3. איכות - בניית מנגנונים מתקדמים כמו חישובי מחירים אוטומטיים
4. גמישות - אפשרות לבדוק ולהתאים את המערכת בכל שלב
5. סינרגיה - שילוב כל רכיבי המערכת לחוויית משתמש מושלמת

בסיום חמשת השלבים, תתקבל מערכת ניהול הזמנות מלאה, יציבה וידידותית למשתמש, המאפשרת ניהול מלא של הזמנות בשני מקומות האירוח תוך שמירה על סנכרון מלא עם מערכת ניהול החדרים.
